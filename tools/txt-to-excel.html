<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Premium .TXT to Excel Converter - NurulNC.Site</title>
    
    <meta name="description" content="টেক্সট ফাইল থেকে এক্সেল শীটে কনভার্ট করুন সহজে। NurulINC-এর প্রিমিয়াম .TXT to .XLSX কনভার্টার টুল।">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', 'Hind Siliguri', sans-serif; background-color: #f8fafc; }
        .premium-card { background: white; border-radius: 2.5rem; border: 1px solid rgba(0,0,0,0.05); transition: all 0.3s ease; }
        .upload-area { border: 2px dashed #e2e8f0; border-radius: 2rem; transition: all 0.3s; cursor: pointer; background: #fafafa; }
        .upload-area:hover, .upload-area.dragover { border-color: #4f46e5; background: #f5f3ff; }
        .preview-box { font-family: 'Inter', monospace; background: #fafafa; border-radius: 1.5rem; overflow-x: auto; }
        .ad-space { background: #f1f5f9; border: 2px dashed #cbd5e1; border-radius: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <header class="bg-white border-b py-4 sticky top-0 z-50">
        <div class="container mx-auto px-4 flex justify-between items-center max-w-7xl">
            <a href="../index.html" class="text-2xl font-black text-indigo-600 italic tracking-tighter uppercase">NurulINC<span class="text-slate-400">.SITE</span></a>
            <a href="../index.html" class="text-sm font-bold text-indigo-600 uppercase italic flex items-center">
                <i data-lucide="home" class="w-4 h-4 mr-1"></i> Home
            </a>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-8 max-w-4xl flex flex-col items-center">
        
        <div class="ad-space w-full max-w-[728px] h-[90px] mb-10">
            <span class="text-slate-400 text-[10px] tracking-widest uppercase font-black italic">Advertisement Banner</span>
        </div>

        <div class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-black italic uppercase tracking-tight text-slate-900 leading-tight">
                .TXT → <span class="text-indigo-600">Excel</span>
            </h1>
            <p class="text-slate-500 text-sm mt-3 font-bold tracking-widest uppercase italic">Professional Data Format Converter</p>
        </div>

        <div class="premium-card w-full p-8 md:p-12 shadow-sm border border-slate-100">
            
            <div class="upload-area p-10 text-center mb-8" id="uploadArea">
                <div class="bg-indigo-50 w-16 h-16 rounded-2xl flex items-center justify-center text-indigo-600 mx-auto mb-4">
                    <i data-lucide="upload-cloud" class="w-8 h-8"></i>
                </div>
                <p class="text-slate-600 font-bold italic mb-2">ফাইল এখানে ড্রপ করুন অথবা ক্লিক করুন</p>
                <p class="text-slate-400 text-xs uppercase tracking-widest font-black italic">Supports .TXT Files Only</p>
                <input type="file" id="fileInput" accept=".txt" class="hidden" />
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 bg-slate-50 p-6 rounded-[2rem] border border-slate-100">
                <div class="flex flex-col justify-center">
                    <label class="block text-[10px] font-black uppercase text-slate-400 mb-4 tracking-widest italic">Select Delimiter (বিচ্ছেদ চিহ্ন)</label>
                    <div class="grid grid-cols-2 gap-3">
                        <label class="flex items-center text-xs font-bold text-slate-600 italic cursor-pointer">
                            <input type="radio" name="delimiter" value="tab" checked class="mr-2 text-indigo-600"> Tab
                        </label>
                        <label class="flex items-center text-xs font-bold text-slate-600 italic cursor-pointer">
                            <input type="radio" name="delimiter" value="comma" class="mr-2 text-indigo-600"> Comma (,)
                        </label>
                        <label class="flex items-center text-xs font-bold text-slate-600 italic cursor-pointer">
                            <input type="radio" name="delimiter" value="semicolon" class="mr-2 text-indigo-600"> Semicolon (;)
                        </label>
                        <label class="flex items-center text-xs font-bold text-slate-600 italic cursor-pointer">
                            <input type="radio" name="delimiter" value="space" class="mr-2 text-indigo-600"> Space
                        </label>
                    </div>
                </div>
                <button id="convertBtn" disabled class="bg-indigo-600 text-white font-black uppercase tracking-widest py-4 rounded-2xl hover:bg-indigo-700 transition shadow-lg shadow-indigo-100 disabled:bg-slate-300 disabled:shadow-none flex items-center justify-center gap-2">
                    <i data-lucide="file-check" class="w-5 h-5"></i> Convert & Download
                </button>
            </div>

            <div id="previewContainer" class="hidden space-y-3">
                <label class="block text-[10px] font-black uppercase text-slate-400 tracking-widest italic ml-4">Data Preview</label>
                <pre id="preview" class="preview-box p-6 text-xs text-slate-600 italic leading-relaxed h-40 overflow-y-auto"></pre>
            </div>
        </div>

        <div class="ad-space w-full max-w-[728px] h-[90px] mt-10">
            <span class="text-slate-400 text-[10px] tracking-widest uppercase font-black italic">Bottom Ad Banner</span>
        </div>
    </main>

    <footer class="bg-slate-900 text-slate-500 py-8 text-center text-[10px] font-bold uppercase tracking-widest mt-auto">
        © 2024 NurulNC | Smart Data Converters
    </footer>

    <script>
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const convertBtn = document.getElementById('convertBtn');
        const preview = document.getElementById('preview');
        const previewContainer = document.getElementById('previewContainer');
        let fileContent = '';

        uploadArea.onclick = () => fileInput.click();

        // Drag & Drop
        uploadArea.ondragover = (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); };
        uploadArea.ondragleave = () => uploadArea.classList.remove('dragover');
        uploadArea.ondrop = (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            handleFiles(e.dataTransfer.files);
        };

        fileInput.onchange = () => handleFiles(fileInput.files);

        function handleFiles(files) {
            if (!files.length) return;
            const file = files[0];
            if (!file.name.toLowerCase().endsWith('.txt')) {
                alert('দয়া করে শুধুমাত্র .txt ফাইল আপলোড করুন!');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                fileContent = e.target.result;
                preview.textContent = fileContent.length > 500 ? fileContent.slice(0, 500) + '...' : fileContent;
                previewContainer.classList.remove('hidden');
                convertBtn.disabled = false;
                uploadArea.querySelector('p').innerHTML = `<span class="text-indigo-600">${file.name}</span> আপলোড হয়েছে`;
            };
            reader.readAsText(file, 'UTF-8');
        }

        convertBtn.onclick = () => {
            if (!fileContent.trim()) return;

            const delimiter = document.querySelector('input[name="delimiter"]:checked').value;
            let separator = delimiter === 'comma' ? ',' : (delimiter === 'semicolon' ? ';' : (delimiter === 'space' ? /\s+/ : '\t'));

            const lines = fileContent.trim().split('\n').filter(l => l.trim() !== '');
            const data = lines.map(line => delimiter === 'space' ? line.trim().split(separator) : line.split(separator));

            if (!data.length) { alert('কোনো বৈধ ডেটা পাওয়া যায়নি!'); return; }

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "NurulINC_Data");

            const defaultName = fileInput.files[0]?.name.replace('.txt', '') || 'converted_data';
            XLSX.writeFile(wb, `${defaultName}.xlsx`);
        };

        lucide.createIcons();
    </script>
</body>
</html>
